# Install and load required libraries
install.packages("readr")     # Install only if not already installed
library(readr)

if (!require("readxl")) install.packages("readxl")
if (!require("ggplot2")) install.packages("ggplot2")

library(readxl)
library(ggplot2)

# Read the dataset from the Excel file
df <- read_csv("baggagecomplaints.csv")

# Print summary of the dataset
print(summary(df))

# Calculate average baggage complaints per airline
airline_avg <- aggregate(Baggage ~ Airline, data = df, FUN = mean)
print(airline_avg)

# Filter data for specific airlines
selected <- df[df$Airline %in% c("American Eagle", "Hawaiian", "United"), ]

# Calculate yearly average complaints for selected airlines
yearly_avg <- aggregate(Baggage ~ Year + Airline, data = selected, FUN = mean)

# Plot the data using a line plot
ggplot(yearly_avg, aes(x = Year, y = Baggage, color = Airline)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  theme_minimal() +
  labs(
    title = "Yearly Average Baggage Complaints",
    x = "Year",
    y = "Average Complaints"
  )
